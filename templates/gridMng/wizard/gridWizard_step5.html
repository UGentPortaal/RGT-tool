{% extends 'gridMng/wizard/gridWizard_base.html' %}
{% load wizard_extras %}

{% block stylesheet %}
<style type="text/css">
#alternative-name {
	font-weight: bold;
}
select > option.incomplete {
	color: red;
}
#concern-list-wrapper {
	margin-top: 10px;
}
#concern-list-data {
	margin-top: 5px;
	padding-left: 5px;
}
.conc-rating-wrapper {
	overflow: hidden;
	margin: 5px 0px;
}
.conc-label {
	float: left;
	margin-right: 3px;
}
.sep {
	float: left;
	margin-right: 3px;
}
.rating-selection {
	float: left;
	margin-left: 10px;
}
#form-menu {
	margin-top: 10px;
}
</style>
{% endblock stylesheet %}

{% block javascript %}
<script type="text/javascript" src="{{ STATIC_URL }}js/wizard/wizard-step_5.js"></script>
{% endblock javascript %}

{% block step_info %}
<div class="step-header">
	<p>In this step you can select an alternative, and rate it against the concerns.<br />
	Alternatives marked with red color are not completed. Make sure that you selected a rating for every concern of every alternative.</p>
</div>
{% endblock step_info %}

{% block wizard_top_content %}
<div id="alternatives-wrapper">
	<div id="alternatives-selection-wrapper">
		<select id="alternatives-list" size="{{ alternatives_length }}">
		{% for alternative in alternatives_data|sort_dict_by_key %}
			{% if forloop.counter == 1 %}
				<option id="{{ alternative.0 }}" selected="selected">{{ alternative.1 }}</option>
			{% else %}
				<option id="{{ alternative.0 }}">{{ alternative.1 }}</option>
			{% endif %}
		{% endfor %}
		</select>
	</div>
</div>
<div id="concern-list-wrapper">
	<div id="concern-list-header">
		<p>Insert a rating for each concern, for the alternative <span id="alternative-name"></span>.</p>
	</div>
	<div id="concern-list-data">
		<div class="conc-rating-wrapper">
		{% for concern in concerns_data|sort_dict_by_key %}
			<div class="conc-label">
				<span>{{ concern.1 }}</span>
			</div>
			{% if forloop.counter|divisibleby:"2" %}
				<div class="rating-selection">
				{% for x in 5|get_range %}
					<input type="radio" name="concern-{{ forloop.parentloop.counter|divide_by:2 }}" value="{{ x|add:'1' }}" id="{{ forloop.parentloop.counter|divide_by:2 }}-{{ x|add:'1' }}" class="rating" />
				{% endfor %}
				</div>
				{% if forloop.counter < concerns_data|length %}
				</div>
				<div class="conc-rating-wrapper">
				{% endif %}
			{% else %}
			<div class="sep">
				<span>--</span>
			</div>
			{% endif %}
		{% endfor %}
		</div>
	</div>
</div>
{% endblock wizard_top_content %}

{% block wizard_form_content %}
<div class="data-wrapper">
	{% if wizard.form.fields|length > 0 %}
		<div id="input1" class="rca-data">
		{% for field in wizard.form %}
			{{ field }}
			{% if forloop.counter|divisibleby:concerns_length %}
				{% if forloop.counter|divide_by:concerns_length < wizard.form.fields|length|divide_by:concerns_length %}
					</div>
					<div id="input{{ forloop.counter|divide_by:concerns_length|add:'1' }}" class="rca-data">
				{% endif %}
			{% endif %}
		{% endfor %}
		</div>
	{% else %}
		{% for alternative in alternatives_data|sort_dict_by_key %}
		<div id="input{{ forloop.counter }}" class="rca-data">
			{% for concern in concerns_data|sort_dict_by_key %}
				{% if forloop.counter|divisibleby:"2" %}
					<input type="hidden" name="4-rating-concern{{ forloop.counter|divide_by:2 }}-alternative{{ forloop.parentloop.counter }}" value="0" id="id_4-rating-concern{{ forloop.counter|divide_by:2 }}-alternative{{ forloop.parentloop.counter }}" />
				{% endif %}
			{% endfor %}
		</div>
		{% endfor %}
	{% endif %}
	{% if wizard.form.errors %}
	<div class="form-errors-wrapper">
		<div class="error">
			{% for error in wizard.form.non_field_errors %}
				<p>{{ error }}</p>
			{% endfor %}
		</div>
	</div>
	{% endif %}
	<div id="extra-data">
		<input type="hidden" name="num-alternatives" value="{{ alternatives_length }}" id="num-alternatives" />
		<input type="hidden" name="num-concerns" value="{{ concerns_length }}" id="num-concerns" />
	</div>
</div>
{% endblock wizard_form_content %}